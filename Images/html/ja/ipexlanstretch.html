
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<!-- This HTML was auto-generated from MATLAB code. To make changes, update the MATLAB code and republish this document.       --><title>複数のスペクトルのカラー合成イメージの強調</title><meta name="generator" content="MATLAB 7.14"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2011-11-15"><meta name="DC.source" content="ipexlanstretch.m"><link rel="stylesheet" type="text/css" href="../../../../matlab/helptools/private/style.css"><link rel="stylesheet" type="text/css" href="../../../../matlab/helptools/private/style_ja_JP.css"></head><body><div class="header"><div class="left"><a href="matlab:edit ipexlanstretch">エディターで ipexlanstretch.m を開く</a></div><div class="right"><a href="matlab:echodemo ipexlanstretch">コマンド ウィンドウで実行</a></div></div><div class="content"><h1>複数のスペクトルのカラー合成イメージの強調</h1><!--introduction--><p>視覚的な解釈に適切なイメージを作成するために、複数のスペクトルの輝度または反射データの強調が必要な場合があります。</p><p>この例は、複数のスペクトル データを使用していくつかの基本的なイメージの合成と強調方法を説明します。フランスのパリの一部を撮影した Landsat Thematic Mapper イメージを使用します。7 つのスペクトル バンドは Erdas LAN 形式の 1 つのファイルに格納されます。ここで説明する概念は以下のとおりです。</p><div><ul><li>Erdas LAN 形式のファイルから複数のスペクトル データを読み取る</li><li>異なる帯域の組み合わせからのカラー合成の作成</li><li>コントラスト ストレッチによるイメージの強調</li><li>無相関ストレッチによるイメージの強調</li><li>散布図の使用</li></ul></div><!--/introduction--><h2>目次</h2><div><ul><li><a href="#1">手順 1:複数のスペクトル イメージからのトゥルーカラー合成イメージの作成</a></li><li><a href="#3">手順 2:ヒストグラムを使用した非強化トゥルーカラー合成イメージの調査</a></li><li><a href="#4">手順 3:相関を使用した非強化トゥルーカラー合成イメージの調査</a></li><li><a href="#6">手順 4:コントラスト ストレッチによるトゥルーカラー合成イメージの強化</a></li><li><a href="#7">手順 5:コントラスト ストレッチ後のヒストグラムのチェック</a></li><li><a href="#8">手順 6:無相関ストレッチによるトゥルーカラー合成イメージの強化</a></li><li><a href="#10">手順 7:無相関ストレッチ後の相関のチェック</a></li><li><a href="#11">手順 8:CIR 合成イメージの構成と強化</a></li></ul></div><h2>手順 1:複数のスペクトル イメージからのトゥルーカラー合成イメージの作成<a name="1"></a></h2><p>LAN ファイル <tt>paris.lan</tt> には、7 帯域の 512&times;512 の Landsat イメージが含まれています。128 バイトのヘッダーに続くピクセル値は、帯域番号の昇順による BIL (Band Interleaved by Line) 形式です。リトルエンディアンの順番で符号なし 8 ビット整数として保存されます。</p><p>MATLAB&reg; 関数 <tt>multibandread</tt> を使用して LAN ファイルから帯域 3、2、および 1 を読み取ります。これらの帯域は、スペクトルの可視部分を対象とします。それぞれが RGB イメージである赤、緑、および青の平面にマッピングされる場合、その結果は標準のトゥルーカラー合成イメージになります。<tt>multibandread</tt> への最後の入力引数では、読み取る帯域と、その順序を指定します。そのため、1 ステップで RGB 合成イメージを構築できます。</p><pre class="codeinput">truecolor = multibandread(<span class="string">'paris.lan'</span>, [512, 512, 7], <span class="string">'uint8=&gt;uint8'</span>, <span class="keyword">...</span>
                          128,  <span class="string">'bil'</span>, <span class="string">'ieee-le'</span>, {<span class="string">'Band'</span>,<span class="string">'Direct'</span>,[3 2 1]});
</pre><p>トゥルーカラー合成イメージにはわずかなコントラストしかなく、色は一致していません。</p><pre class="codeinput">figure
imshow(truecolor);
title(<span class="string">'Truecolor Composite (Un-enhanced)'</span>)
text(size(truecolor,2), size(truecolor,1) + 15,<span class="keyword">...</span>
  <span class="string">'Image courtesy of Space Imaging, LLC'</span>,<span class="keyword">...</span>
  <span class="string">'FontSize'</span>, 7, <span class="string">'HorizontalAlignment'</span>, <span class="string">'right'</span>)
</pre><img vspace="5" hspace="5" src="../ipexlanstretch_01.png" alt=""> <h2>手順 2:ヒストグラムを使用した非強化トゥルーカラー合成イメージの調査<a name="3"></a></h2><p>赤い帯域のヒストグラムを表示すると、たとえば、使用可能なダイナミック レンジの一部分内にデータが集中することがわかります。これは、トゥルーカラー合成イメージが暗く見える理由の 1 つです。</p><pre class="codeinput">figure
imhist(truecolor(:,:,1))
title(<span class="string">'Histogram of the Red Band (Band 3)'</span>)
</pre><img vspace="5" hspace="5" src="../ipexlanstretch_02.png" alt=""> <h2>手順 3:相関を使用した非強化トゥルーカラー合成イメージの調査<a name="4"></a></h2><p>合成イメージが暗く見えるもう 1 つの理由は、可視帯域が互いに高い相関をもっていることです。2 および 3 帯域の散布図は、スペクトル帯間の相関度合を測定するための有効な方法です。<tt>plot</tt> を使用することで簡単に行うことができます。</p><pre class="codeinput">r = truecolor(:,:,1);
g = truecolor(:,:,2);
b = truecolor(:,:,3);
figure
plot3(r(:),g(:),b(:),<span class="string">'.'</span>)
grid(<span class="string">'on'</span>)
xlabel(<span class="string">'Red (Band 3)'</span>)
ylabel(<span class="string">'Green (Band 2)'</span>)
zlabel(<span class="string">'Blue (Band 1)'</span>)
title(<span class="string">'Scatterplot of the Visible Bands'</span>)
</pre><img vspace="5" hspace="5" src="../ipexlanstretch_03.png" alt=""> <p>赤-緑-青の散布図の明白な線形トレンドは、可視帯域に高い相関があることを示しています。これは、非強化トゥルーカラー合成イメージの単色表示を説明するのに役立ちます。</p><h2>手順 4:コントラスト ストレッチによるトゥルーカラー合成イメージの強化<a name="6"></a></h2><p><tt>imadjust</tt> を使用して線形コントラスト ストレッチをトゥルーカラー合成イメージに適用すると、表面の特徴をより認識しやすくなります。</p><pre class="codeinput">stretched_truecolor = imadjust(truecolor,stretchlim(truecolor));
figure
imshow(stretched_truecolor)
title(<span class="string">'Truecolor Composite after Contrast Stretch'</span>)
</pre><img vspace="5" hspace="5" src="../ipexlanstretch_04.png" alt=""> <h2>手順 5:コントラスト ストレッチ後のヒストグラムのチェック<a name="7"></a></h2><p>コントラスト ストレッチの適用後、赤い帯域のヒストグラムは、より大きな使用可能なダイナミック レンジにデータが広がっていることを示します。</p><pre class="codeinput">figure
imhist(stretched_truecolor(:,:,1))
title(<span class="string">'Histogram of Red Band (Band 3) after Contrast Stretch'</span>)
</pre><img vspace="5" hspace="5" src="../ipexlanstretch_05.png" alt=""> <h2>手順 6:無相関ストレッチによるトゥルーカラー合成イメージの強化<a name="8"></a></h2><p>トゥルーカラー合成イメージを強化するもう 1 つの方法は、無相関ストレッチを使用することです。これは、高い相関があるチャンネルの全域にわたって色の分離を強化します。<tt>decorrstretch</tt> を使用して、無相関ストレッチを実行します (その後に、オプションのパラメーター値の組みである <tt>'Tol'</tt> と <tt>0.1</tt> で指定したように、線形コントラスト ストレッチが続きます)。</p><pre class="codeinput">decorrstretched_truecolor = decorrstretch(truecolor, <span class="string">'Tol'</span>, 0.01);
figure
imshow(decorrstretched_truecolor)
title(<span class="string">'Truecolor Composite after Decorrelation Stretch'</span>)
</pre><img vspace="5" hspace="5" src="../ipexlanstretch_06.png" alt=""> <p>再び、表面の特徴はより明確に観測できるようになりますが、方法が異なります。表示全域のスペクトル差異が誇張されます。注目すべき例は、左端の緑の領域です。これはコントラスト ストレッチが行われた合成イメージでは黒く見えます。この緑の領域は、ブーローニュの森です。パリの西端にある大きな公園です。</p><h2>手順 7:無相関ストレッチ後の相関のチェック<a name="10"></a></h2><p>予想されるとおり、無相関ストレッチが後に続く散布図は、相関における急激な減少を示します。</p><pre class="codeinput">r = decorrstretched_truecolor(:,:,1);
g = decorrstretched_truecolor(:,:,2);
b = decorrstretched_truecolor(:,:,3);
figure
plot3(r(:),g(:),b(:),<span class="string">'.'</span>)
grid(<span class="string">'on'</span>)
xlabel(<span class="string">'Red (Band 3)'</span>)
ylabel(<span class="string">'Green (Band 2)'</span>)
zlabel(<span class="string">'Blue (Band 1)'</span>)
title(<span class="string">'Scatterplot of the Visible Bands after Decorrelation Stretch'</span>)
</pre><img vspace="5" hspace="5" src="../ipexlanstretch_07.png" alt=""> <h2>手順 8:CIR 合成イメージの構成と強化<a name="11"></a></h2><p>可視帯域と同じように、スペクトルの不可視帯域を対象とする Landsat 帯域からの情報は、RGB 合成イメージを構成して強化することによって参照できます。この部分のスペクトルにおけるクロロフィルの高反射率のため、近赤外線 (NIR) 帯域 (帯域 4) は重要です。そして、可視赤色光と緑色光 (それぞれ帯域 3 と 2) を結合し、カラー赤外 (CIR) 合成イメージを形成する場合は、特に役立ちます。カラー赤外 (CIR) 合成イメージは通常、植生を特定するか、または植生の成長や状態を評価する場合に使用されます。</p><p>元の LAN ファイルから読み取り、帯域 4、3、および 2 をそれぞれ、赤、緑、青にマッピングする RGB イメージを構成することで、CIR 合成イメージを構築します。</p><pre class="codeinput">CIR = multibandread(<span class="string">'paris.lan'</span>, [512, 512, 7], <span class="string">'uint8=&gt;uint8'</span>, <span class="keyword">...</span>
                    128,  <span class="string">'bil'</span>, <span class="string">'ieee-le'</span>, {<span class="string">'Band'</span>,<span class="string">'Direct'</span>,[4 3 2]});
</pre><p>近赤外線 (NIR) 帯域 (帯域 4) が、互いに相関している可視帯域と比較して、可視帯域との相関性が低くても、無相関ストレッチによって多くの特徴が見やすくなります。</p><pre class="codeinput">stretched_CIR = decorrstretch(CIR, <span class="string">'Tol'</span>, 0.01);
figure
imshow(stretched_CIR)
title(<span class="string">'CIR after Decorrelation Stretch'</span>)
</pre><img vspace="5" hspace="5" src="../ipexlanstretch_08.png" alt=""> <p>カラー赤外合成イメージの特性は、植生 (クロロフィル) 密度が高い領域で赤く見えることです。CIR 合成イメージでは、ブーローニュの森公園は赤く見えることに注意してください。これは、無相関ストレッチが行われたトゥルーカラー合成イメージにおける緑の表示と一致します。</p><p><tt>decorrstretch</tt>、<tt>imhist</tt>、<tt>imadjust</tt>、<tt>multibandread</tt>、<tt>stretchlim</tt> も参照してください。</p><p class="footer">Copyright 1993-2008 The MathWorks, Inc.<br>Published with MATLAB&reg; 7.13</p><p class="footer" id="trademarks">MATLAB and Simulink are registered trademarks of The MathWorks, Inc.  Please see <a href="http://www.mathworks.com/trademarks">www.mathworks.com/trademarks</a> for a list of other trademarks owned by The MathWorks, Inc.  Other product or brand names are trademarks or registered trademarks of their respective owners.</p></div><!-- ##### SOURCE BEGIN ##### %% Enhancing Multispectral Color Composite Images % It is often necessary to enhance multispectral radiance or reflectance  % data to create an image that is suitable for visual interpretation. % % This example illustrates some basic image composition and enhancement % techniques for use with multispectral data.  It uses Landsat thematic % mapper imagery covering part of Paris, France.  Seven spectral bands are % stored in one file in the Erdas LAN format. Concepts covered include: %  % * Reading multispectral data from Erdas LAN files % * Constructing color composites from different band combinations % * Enhancing imagery with a contrast stretch % * Enhancing imagery with a decorrelation stretch % * Using scatterplots  % Copyright 1993-2008 The MathWorks, Inc.    %% Step 1: Construct Truecolor Composite from a Multispectral Image % The LAN file, |paris.lan|, contains a 7-band 512-by-512 Landsat image.  % A 128-byte header is followed by the pixel values, which are band % interleaved by line (BIL) in order of increasing band number.  They % are stored as unsigned 8-bit integers, in little-endian byte order. % % Read bands 3, 2, and 1 from the LAN file using the MATLAB(R) function % |multibandread|.  These bands cover the visible part of the spectrum. % When they are mapped to the red, green, and blue planes, respectively, of % an RGB image, the result is a standard truecolor composite.  The final % input argument to |multibandread| specifies which bands to read, and in % which order, so that you can construct an RGB composite in a single step. truecolor = multibandread('paris.lan', [512, 512, 7], 'uint8=>uint8', ...                           128,  'bil', 'ieee-le', {'Band','Direct',[3 2 1]});  %% % The truecolor composite has very little contrast and the colors are % unbalanced. figure imshow(truecolor); title('Truecolor Composite (Un-enhanced)') text(size(truecolor,2), size(truecolor,1) + 15,...   'Image courtesy of Space Imaging, LLC',...   'FontSize', 7, 'HorizontalAlignment', 'right')  %% Step 2: Use Histograms to Explore Un-Enhanced Truecolor Composite % % By viewing a histogram of the red band, for example, you can see that the % data is concentrated within a small part of the available dynamic range. % This is one reason why the truecolor composite appears dull. figure imhist(truecolor(:,:,1)) title('Histogram of the Red Band (Band 3)')  %% Step 3: Use Correlation to Explore Un-Enhanced Truecolor Composite % Another reason for the dull appearance of the composite is that the % visible bands are highly correlated with each other.  Two- and three-band % scatterplots are an excellent way to gauge the degree of correlation % among spectral bands.  You can make them easily just by using |plot|. r = truecolor(:,:,1); g = truecolor(:,:,2); b = truecolor(:,:,3); figure  plot3(r(:),g(:),b(:),'.') grid('on') xlabel('Red (Band 3)') ylabel('Green (Band 2)') zlabel('Blue (Band 1)') title('Scatterplot of the Visible Bands')  %% % The pronounced linear trend of the red-green-blue scatterplot indicates % that the visible bands are highly correlated. This helps explain the % monochromatic look of the un-enhanced truecolor composite.  %% Step 4: Enhance Truecolor Composite with a Contrast Stretch % When you use |imadjust| to apply a linear contrast stretch to the % truecolor composite image, the surface features are easier to recognize. stretched_truecolor = imadjust(truecolor,stretchlim(truecolor)); figure imshow(stretched_truecolor) title('Truecolor Composite after Contrast Stretch')  %% Step 5: Check Histogram Following the Contrast Stretch % A histogram of the red band after applying a contrast stretch shows that % the data has been spread over much more of the available dynamic range.  figure imhist(stretched_truecolor(:,:,1)) title('Histogram of Red Band (Band 3) after Contrast Stretch')  %% Step 6: Enhance Truecolor Composite with a Decorrelation Stretch % Another way to enhance the truecolor composite is to use a decorrelation % stretch, which enhances color separation across highly correlated % channels. Use |decorrstretch| to perform the decorrelation stretch % (followed by a linear contrast stretch, as specified by the optional % parameter-value pair |'Tol'| and |0.1|).  decorrstretched_truecolor = decorrstretch(truecolor, 'Tol', 0.01); figure imshow(decorrstretched_truecolor) title('Truecolor Composite after Decorrelation Stretch')  %% % Again, surface features have become much more clearly visible, but in a % different way.  The spectral differences across the scene have been % exaggerated.  A noticeable example is the area of green on the left edge, % which appears black in the contrast-stretched composite. This green area % is the Bois de Boulogne, a large park on the western edge of Paris.  %% Step 7: Check Correlation Following the Decorrelation Stretch % As expected, a scatterplot following the decorrelation stretch shows a % strong decrease in correlation.  r = decorrstretched_truecolor(:,:,1); g = decorrstretched_truecolor(:,:,2); b = decorrstretched_truecolor(:,:,3); figure  plot3(r(:),g(:),b(:),'.') grid('on') xlabel('Red (Band 3)') ylabel('Green (Band 2)') zlabel('Blue (Band 1)') title('Scatterplot of the Visible Bands after Decorrelation Stretch')  %% Step 8: Construct and Enhance a CIR Composite % Just as with the visible bands, information from Landsat bands covering % non-visible portions of the spectrum can be viewed by constructing and % enhancing RGB composite images.  The near infrared (NIR) band (Band 4) is % important because of the high reflectance of chlorophyll in this part of % the spectrum.  It is even more useful when combined with visible red and % green (Bands 3 and 2, respectively) to form a color infrared (CIR) composite % image. Color infrared (CIR) composites are commonly used to identify % vegetation or assess its state of growth and/or health.  %% % Construct a CIR composite by reading from the original LAN file and % composing an RGB image that maps bands 4, 3, and 2 to red, green, and % blue, respectively. CIR = multibandread('paris.lan', [512, 512, 7], 'uint8=>uint8', ...                     128,  'bil', 'ieee-le', {'Band','Direct',[4 3 2]});   %% % Even though the near infrared (NIR) band (Band 4) is less correlated with % the visible bands than the visible bands are with each other, a % decorrelation stretch makes many features easier to see. stretched_CIR = decorrstretch(CIR, 'Tol', 0.01); figure imshow(stretched_CIR) title('CIR after Decorrelation Stretch')  %% % A property of color infrared composites is that they look red in areas % with a high vegetation (chlorophyll) density. Notice that the Bois de % Boulogne park is red in the CIR composite, which is consistent with its % green appearance in the decorrelation-stretched truecolor composite.  %% % See also |decorrstretch|, |imhist|, |imadjust|, |multibandread|, % |stretchlim|.   displayEndOfDemoMessage(mfilename)  ##### SOURCE END ##### --></body></html>